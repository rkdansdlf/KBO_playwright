version: "3.9"

services:
  crawler:
    build: .
    env_file:
      - .env
    environment:
      DATABASE_URL: ${DATABASE_URL:-sqlite:///./data/kbo_dev.db}
      TARGET_DATABASE_URL: ${TARGET_DATABASE_URL:-}
      SOURCE_DATABASE_URL: ${SOURCE_DATABASE_URL:-sqlite:///./data/kbo_dev.db}
      RUN_INIT_DB: ${RUN_INIT_DB:-0}
      RUN_SYNC_SUPABASE: ${RUN_SYNC_SUPABASE:-0}
      SYNC_TRUNCATE: ${SYNC_TRUNCATE:-0}
    volumes:
      - ./tests/fixtures:/app/tests/fixtures:ro
      - ./data:/app/data
    command: ["python", "-m", "src.cli.run_pipeline_demo", "--help"]
